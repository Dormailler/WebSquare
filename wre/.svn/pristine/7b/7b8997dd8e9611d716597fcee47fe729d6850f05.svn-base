<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko"><head><title>[GridView] 엑셀 다운로드 시 서브토탈(subTotal)의 데이터를 브라우저에 표시된 데이터로 전달하기</title><link rel="stylesheet" href="css/book.css" type="text/css" /><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" /><meta name="EPB-UUID" content="db7d7f842b451ed6" /></head><body><div id="content"><h1 id="r_9004182ac5460780" class="chapter_title">[GridView] 엑셀 다운로드 시 서브토탈(subTotal)의 데이터를 브라우저에 표시된 데이터로 전달하기</h1><h1 id="r_60f07434a9229a53" class="element heading1" data-element-id="60f07434a9229a53"><div class="r_heading_inner"><span class="heading1_n">1</span><span>개요</span></div></h1><pre id="r_0b99f89653bb5ada" class="element pre" data-element-id="0b99f89653bb5ada">GridView의 엑셀 다운로드(함수 'advancedExcelDownload')에서 첫 번째 인자 'options'의 'useSubTotalData' 옵션 설정 예제입니다. 
옵션 'useSubTotalData'은 엑셀에 'subTotal'(소계)의 데이터를 브라우저에 표시된 값으로 출력할지 여부를 결정합니다.
'useSubTotalData'를 'true'로 설정하지 않고 'subTotal' 컬럼의 표현식(속성 'expression')에 사용자 정의 함수를 호출하면, 엑셀 생성 시 오류가 발생합니다.</pre><p id="r_181476a4170fbb5f" class="element r_example_link_p" data-element-id="181476a4170fbb5f"><a class="link" href="http://example.websquare.kr/exampleLink.html?p=P00269">P00269</a></p><h1 id="r_a5d43452a6d2ba84" class="element heading1" data-element-id="a5d43452a6d2ba84"><div class="r_heading_inner"><span class="heading1_n">2</span><span>구현된 기능</span></div></h1><ul id="r_4a7639a522752d8e" class="element unordered_list" data-element-id="4a7639a522752d8e"><li><p>엑셀 다운로드 - 기본 동작</p></li><li><p>엑셀 다운로드 - subTotal의 값을 브라우저에 표시된 값으로 출력하기</p></li></ul><h1 id="r_578c7cb71ebc1ee2" class="element heading1" data-element-id="578c7cb71ebc1ee2"><div class="r_heading_inner"><span class="heading1_n">3</span><span>예제 테스트 방법</span></div></h1><h2 id="r_baabfb6252cecae1" class="element heading2" data-element-id="baabfb6252cecae1"><div class="r_heading_inner"><span class="heading2_n">3.1</span><span>엑셀 다운로드 - 기본 동작</span></div></h2><p id="r_b4d28fc9516188e2" class="element r_heading_dt_p" data-element-id="b4d28fc9516188e2">STEP1. 초기 상태 확인하기</p><pre id="r_cc4c2ccafd5ec048" class="element pre" data-element-id="cc4c2ccafd5ec048">GridView에 서브토탈(소계)가 적용되어 있습니다.
컬럼 '하반기'의 소계 영역 값은 컬럼의 합산 금액에 "#,###" 서식을 적용하고 금액 단위인 "원"을 붙여 표시되었습니다.
이 값은 컬럼의 'expression' 속성에서 사용자 정의 함수를 호출해 생성되었습니다.</pre><div id="r_36d1958be978a597" class="element image" data-element-id="36d1958be978a597"><p class="caption"><span class="image_caption_n">그림 1.</span>브라우저(Chrome) 실행 예시</p><p class="content"><img alt="" src="images/image898.png" width="361" height="292" /></p></div><p id="r_a80440cf4b677d62" class="element r_heading_dt_p" data-element-id="a80440cf4b677d62">STEP2. 버튼 <span class="r_exec_btn_style_span">엑셀 다운로드 - 기본 동작</span>을 클릭합니다.</p><pre id="r_b9f6761733c20f10" class="element pre" data-element-id="b9f6761733c20f10">엑셀 다운로드가 되지 않고 서버에서 오류 메시지가 전달됩니다.
영역 [<span class="r_blue001_span">로그 확인</span>]에 출력된 로그를 확인합니다.
-----------------------------------------------------------------
<span class="r_title_log_span">로그 예시</span> 
[03:23:35] 엑셀 다운로드 오류 발생 : [D301]Excel 생성도중 오류
-----------------------------------------------------------------
(브라우저의 개발자 도구 콘솔에도 로그가 출력되며, 반환된 객체를 확인할 수 있습니다.)</pre><h2 id="r_fc6a9f1ea7669c51" class="element heading2" data-element-id="fc6a9f1ea7669c51"><div class="r_heading_inner"><span class="heading2_n">3.2</span><span>엑셀 다운로드 - subTotal의 값을 브라우저에 표시된 값으로 출력하기</span></div></h2><p id="r_a7d0e9794d0059f2" class="element r_heading_dt_p" data-element-id="a7d0e9794d0059f2">STEP1. 초기 상태 확인하기</p><pre id="r_86c11ae503e08db1" class="element pre" data-element-id="86c11ae503e08db1">GridView에 서브토탈(소계)가 적용되어 있습니다.
컬럼 '하반기'의 소계 영역 값은 컬럼의 합산 금액에 "#,###" 서식을 적용하고 금액 단위인 "원"을 붙여 표시되었습니다.
이 값은 컬럼의 'expression' 속성에서 사용자 정의 함수를 호출해 생성되었습니다.</pre><div id="r_65198073d8315dad" class="element image" data-element-id="65198073d8315dad"><p class="caption"><span class="image_caption_n">그림 2.</span>브라우저(Chrome) 실행 예시</p><p class="content"><img alt="" src="images/image898.png" width="361" height="292" /></p></div><p id="r_9eefdf9e82527342" class="element r_heading_dt_p" data-element-id="9eefdf9e82527342">STEP2. 버튼 <span class="r_exec_btn_style_span">엑셀 다운로드 - subTotal의 값을 브라우저에 표시된 값으로 출력하기</span>을 클릭합니다.</p><pre id="r_98e0b9419cf8fd2b" class="element pre" data-element-id="98e0b9419cf8fd2b">엑셀 파일 "SP5_EXAMPLE_P00269_TYPE2.xlsx"이 다운로드 됩니다.</pre><p id="r_7f8dc43f129fc8fb" class="element r_heading_dt_p" data-element-id="7f8dc43f129fc8fb">STEP3. 실행된 결과를 확인합니다.</p><pre id="r_57f0958d5c9aa6a7" class="element pre" data-element-id="57f0958d5c9aa6a7">다운로드 된 엑셀 파일 'SP5_EXAMPLE_P00269_TYPE2.xlsx'을 실행합니다.
서브토탈 영역의 출력 값을 확인합니다.
브라우저에 표시된 값과 동일하게 출력됩니다.</pre><div id="r_bccfe475a9ec4208" class="element image" data-element-id="bccfe475a9ec4208"><p class="caption"><span class="image_caption_n">그림 3.</span>다운로드된 엑셀(2021) 파일 예시</p><p class="content"><img alt="" src="images/image899.png" width="415" height="422" /></p></div><h2 id="r_f897b90b5eb5678d" class="element heading2" data-element-id="f897b90b5eb5678d"><div class="r_heading_inner"><span class="heading2_n">3.3</span><span>엑셀 다운로드 - subTotal의 값을 브라우저에 표시된 값으로 출력하기</span></div></h2><h1 id="r_95a424a958dafa26" class="element heading1" data-element-id="95a424a958dafa26"><div class="r_heading_inner"><span class="heading1_n">4</span><span>구현 예시</span></div></h1><pre id="r_8a33e37271fa0f42" class="element pre" data-element-id="8a33e37271fa0f42">원하는 시점에 GridView의 함수 'advancedExcelDownload' 호출 스크립트를 작성합니다.</pre><ul id="r_52416964a6627e63" class="element unordered_list" data-element-id="52416964a6627e63"><li><p><span class="r_blue001_span">[필수] options.fileName</span> </p><p>&lt;String:Y&gt; 파일명</p></li><li><p><span class="r_blue001_span">[필수] options.useSubTotal</span> </p><p>&lt;String:N&gt; [default: false, true] 다운로드시 SubTotal을 출력 할지 여부 ("true"인경우 출력, "false"인경우 미출력), expression을 지정한 경우 avg,sum,min,max,targetColValue,숫자를 지원 함.</p></li><li><p><span class="r_blue001_span">[필수] options.useSubTotalData</span> </p><p>&lt;String:N&gt; [default: 없음] 기본은 서버에서 계산된 결과를 출력하지만 useSubTotalData="true"시 브라우저에 출력된 subTotal 데이터를 출력함.</p></li><li><p>[선택] options.useXHR</p><p>&lt;String:N&gt; [default: false, true] XHR 방식으로 서버에 전송할지의 유무. true로 지정하지 않으면 Form Submit방식으로 데이터를 전송합니다. 서버에서 엑셀 생성 중 오류가 발생하여 오류 코드를 전달한 경우 옵션 'onFailureCallback'에서 후처리를 위해 true로 설정.</p></li><li><p>[선택] options.onFailureCallback</p><p>&lt;Function:N&gt; [default: 없음] 요청 실패 시 호출할 callback 함수.</p></li></ul><p id="r_bef286c35bfe524f" class="element normal" data-element-id="bef286c35bfe524f">[소스 코드 예시]</p><div id="r_79ab4b17a49af2a3" class="element code support_code_numbering" data-element-id="79ab4b17a49af2a3"><pre><span class="digits_10 code_line"></span><span class="r_h_comment_span">//예제 파일의 스크립트 "scwin.btn_ex2_onclick"를 참고하세요.</span>
<span class="digits_10 code_line"></span>
<span class="digits_10 code_line"></span><span class="r_h_keyword_span">var</span> jsnOptions;
<span class="digits_10 code_line"></span>
<span class="digits_10 code_line"></span>jsnOptions = {
<span class="digits_10 code_line"></span>&nbsp;&nbsp;&nbsp;&nbsp;fileName: <span class="r_h_string_span">"SP5_EXAMPLE_P00269_TYPE2.xlsx"</span>, <span class="r_h_comment_span">// [필수] 엑셀의 파일명</span>
<span class="digits_10 code_line"></span>&nbsp;&nbsp;&nbsp;&nbsp;useSubTotal: <span class="r_h_string_span">"true"</span>, <span class="r_h_comment_span">// [필수] subTotal 표시</span>
<span class="digits_10 code_line"></span>&nbsp;&nbsp;&nbsp;&nbsp;useSubTotalData: <span class="r_h_string_span">"true"</span>, <span class="r_h_comment_span">// [필수] subTotal의 값을 브라우저에 표시된 값으로 출력하기</span>
<span class="digits_10 code_line"></span>&nbsp;&nbsp;&nbsp;&nbsp;useXHR: <span class="r_h_string_span">"true"</span>, <span class="r_h_comment_span">// 서버에서 엑셀 생성 중 오류가 발생하여 오류 코드를 전달한 경우 옵션 'onFailureCallback'에서 후처리를 위한 설정.</span>
<span class="digits_10 code_line"></span>&nbsp;&nbsp;&nbsp;&nbsp;onFailureCallback: scwin.avExcelDownload_error_callback <span class="r_h_comment_span">// 서버에서 엑셀 생성 중 오류가 발생한 경우 후처리 함수. 옵션 'useXHR'이 true로 지정되어야 사용할 수 있습니다.</span>
<span class="digits_10 code_line"></span>};
<span class="digits_10 code_line"></span><span class="r_h_comment_span">// GridView "grd_exam1"의 엑셀 다운로드 실행</span>
<span class="digits_10 code_line"></span>grd_exam1.advancedExcelDownload(jsnOptions);</pre></div><div id="r_47dc20e943f63d7c" class="element code support_code_numbering" data-element-id="47dc20e943f63d7c"><pre><span class="digits_10 code_line"></span><span class="r_h_comment_span">// options.onFailureCallback 함수 정의 예시</span>
<span class="digits_10 code_line"></span>
<span class="digits_10 code_line"></span><span class="r_h_comment_span">/**
<span class="digits_10 code_line"></span> * GridView의 함수 'advancedExcelDownload' 호출 시 서버에서 오류가 발생하면 호출되는 함수
<span class="digits_10 code_line"></span> * 함수 'advancedExcelDownload'의 첫 번째 인자의 'onFailureCallback' 속성에 지정.
<span class="digits_10 code_line"></span> * @param {string} arg1 Request URL
<span class="digits_10 code_line"></span> * @param {object} arg2 엑셀 생성 중 오류 정보가 담긴 JSON 객체.
<span class="digits_10 code_line"></span> * @param {string} arg2.errorCode 오류 코드
<span class="digits_10 code_line"></span> */</span>
<span class="digits_10 code_line"></span>scwin.avExcelDownload_error_callback = <span class="r_h_keyword_span">function</span> (arg1, arg2) {
<span class="digits_10 code_line"></span>    <span class="r_h_comment_span">// arg1 값 예시) '/websquare/xmlToExcel2.wq'</span>
<span class="digits_10 code_line"></span>    <span class="r_h_comment_span">// arg2 값 예시) {errorCode: 'D301'}</span>
<span class="digits_10 code_line"></span>    <span class="r_h_comment_span">// 로직 작성</span>
<span class="digits_10 code_line"></span>};</pre></div><h1 id="r_36e8a296949dac10" class="element heading1" data-element-id="36e8a296949dac10"><div class="r_heading_inner"><span class="heading1_n">5</span><span>주요 API</span></div></h1><dl id="r_86b700cdc0b8f928" class="element definition_list" data-element-id="86b700cdc0b8f928"><dt><span class="r_ex_api_method_span">advancedExcelDownload( options , infoArr )</span></dt><dd><p><em>options.fileName</em></p><p><em>options.useSubTotal</em> </p><p><em>options.useSubTotalData</em> </p><p><em>options.useXHR</em> </p><p><em>options.onFailureCallback</em></p></dd></dl><h1 id="r_bb9feb9eee333b90" class="element heading1" data-element-id="bb9feb9eee333b90"><div class="r_heading_inner"><span class="heading1_n">6</span><span>참고 문서</span></div></h1><ul id="r_03b9db2ede3b5d11" class="element unordered_list" data-element-id="03b9db2ede3b5d11"><li><p><strong>[웹스퀘어5 SP5 개발 가이드] GridView</strong> </p><p>링크 : <a class="link" href="https://docs1.inswave.com/sp5_user_guide/bc10c1b82c9a2a0b#e1c4658baf7e726f">https://docs1.inswave.com/sp5_user_guide/bc10c1b82c9a2a0b#e1c4658baf7e726f</a></p></li><li><p><strong>[웹스퀘어5 SP5 개발 가이드] GridView → Excel 다운로드</strong> </p><p>링크 : <a class="link" href="https://docs1.inswave.com/sp5_user_guide/bc10c1b82c9a2a0b#9fb910628c27d550">https://docs1.inswave.com/sp5_user_guide/bc10c1b82c9a2a0b#9fb910628c27d550</a></p></li></ul></div></body></html>